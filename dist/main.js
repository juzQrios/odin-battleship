!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=2)}([function(e,r,t){},function(e,r,t){},function(e,r,t){"use strict";t.r(r);t(0),t(1);var n=e=>{let r,t=0;const n=()=>r;return{name:e,play:(e,r)=>{try{n().receiveAttack(e,r)}catch(e){throw new Error("Wrong move")}},getScore:()=>t,setEnemyBoard:e=>{r=e},getEnemyBoard:n,increaseScore:()=>{t+=1}}};var a=(e,r,t,n)=>{const a=Array(e).fill(0);return{length:e,hitPositions:a,hit:e=>{a[e]="X"},isSunk:()=>a.every(e=>"X"===e),orientation:r,x:t,y:n}};var o=e=>{const r="v",t="h",n=Array(e).fill(0).map(()=>Array(e).fill(0));let o=[];return{cells:n,ships:o,placeShip:(e,r,s,l)=>{const i=a(e,r,s,l);o.push(i),i.orientation===t?(e=>{for(let r=0;r<e.length;r+=1)n[e.x][e.y+r]=o.length})(i):(e=>{for(let r=0;r<e.length;r+=1)n[e.x+r][e.y]=o.length})(i)},receiveAttack:(e,r)=>{if(0===n[e][r])n[e][r]="M";else{if("number"!=typeof n[e][r])throw new Error("Wrong move");{const a=parseInt(n[e][r],10)-1,s=o[a],l=s.orientation===t?r-s.y:e-s.x;s.hit(l),n[e][r]="X"}}},allSunk:()=>o.every(e=>e.isSunk()),validate:(e,t,a,o)=>((e,t,n,a)=>n===r?t[0]-e[0]+1===a:t[1]-e[1]+1===a)(e,t,a,o)&&(e=>e[0]<10&&e[1]<10)(t)&&((e,t,a,o)=>{let s=!0;if(a===r)for(let r=e[0];r<e[0]+o;r+=1)s=s&&0===n[r][e[1]];else for(let r=e[1];r<e[1]+o;r+=1)s=s&&0===n[e[0]][r];return s})(e,0,a,o)&&((e,r)=>e[0]===r[0]||e[1]===r[1])(e,t),resetBoard:()=>{o=[];for(let r=0;r<e;r+=1)for(let t=0;t<e;t+=1)n[r][t]=0}}};var s=(()=>{const e=n("Player"),r=n("Computer"),t=o(10),a=o(10);let s,l;const i=new Set([]),c=[2,3,3,4,5],d=(e,r)=>{const t=Math.floor(Math.random()*(r-e+1))+e,n=i.has(t)?d(e,r):t;return i.add(n),n},u=e=>(l=e,e.increaseScore(),!0),p=(e,r,t)=>{const n=Array.isArray(t)?t:[t],a=Math.floor(Math.random()*(r-e+1))+e;return n.includes(a)?d(e,r,n):a};return{player:e,computer:r,initGame:()=>{e.setEnemyBoard(a),r.setEnemyBoard(t)},resetGame:()=>{t.resetBoard(),a.resetBoard(),i.clear()},startTurn:(t,n)=>{try{e.play(t,n);let a=d(0,99);a=[Math.floor(a/10),a%10],r.play(...a)}catch(e){throw new Error("Wrong move")}},getWinner:()=>l,isFinished:()=>a.allSunk()&&u(e)||t.allSunk()&&u(r),playerBoard:t,computerBoard:a,randomizeShips:e=>{const r=[];for(let t=0;t<c.length;t+=1){const n=p(0,100,i),a=[Math.floor(n/10),n%10],o=[a[0]+c[t]-1,a[1]],s=[a[0],a[1]+c[t]-1];e.validate(a,o,"v",c[t])?(e.placeShip(c[t],"v",...a),r.push(n)):e.validate(a,s,"h",c[t])?(e.placeShip(c[t],"h",...a),r.push(n)):(r.push(n),t-=1)}},getPlayerShipsRandomized:()=>s,setPlayerShipsRandomized:()=>{s=!0}}})();var l=(()=>{const e=[2,3,3,4,5];return{gameLoop:async()=>{for(i.renderMessage('<button class="btn" id="randomize-btn">Randomize Ships</button><button class="btn" id="start-btn">Start placing ships</button>',"player-instruction"),await i.bindListeners(),s.getPlayerShipsRandomized()||await(async()=>{for(let r=0;r<e.length;r+=1){const t=`Place a ship with <span class="ships-number">${e[r]}</span> cells length`;i.renderMessage(t,"player-instruction");let n=await i.getUserInput(".player-cell"),a=await i.getUserInput(".player-cell");const o=n[0]===a[0]?"h":"v";if(n[0]>a[0]||n[1]>a[1]){const e=n;n=a,a=e}s.playerBoard.validate(n,a,o,e[r])?(s.playerBoard.placeShip(e[r],o,...n),i.hideMessage("player-error"),i.renderBoards()):(i.renderMessage("Invalid Move. Try Again.","player-error"),r-=1)}s.randomizeShips(s.computerBoard)})(),i.renderMessage("Attack","player-instruction");!s.isFinished();){const e=await i.getUserInput(".enemy-cell");try{s.startTurn(...e),i.hideMessage("player-error")}catch(e){i.renderMessage(e.message,"player-error")}i.renderBoards()}i.renderMessage(`${s.getWinner().name} won! <button class="btn" id="play-again-btn">Play Again</button>`,"player-instruction"),i.updateScores()}}})();var i=(()=>{const e=document.getElementById("player-score"),r=document.getElementById("computer-score"),t="hit",n="ship",a="empty",o="hidden",i="missed",c=(e,r)=>{const s=document.getElementById(r);e.forEach(e=>{const l=document.createElement("div");l.classList.add("row"),e.forEach(e=>{const s=document.createElement("div");s.classList.add("cell"),s.innerHTML="&#11044;",((e,r)=>{switch(e){case 0:r.classList.add(a);break;case"M":r.classList.add(i);break;case"X":r.classList.add(t);break;default:r.classList.add(n)}})(e,s),l.appendChild(s),"computer-board"===r?(s.classList.remove(n),s.classList.add(o),s.classList.add("enemy-cell")):s.classList.add("player-cell")}),s.appendChild(l)})},d=()=>{document.getElementById("player-board").innerHTML="",document.getElementById("computer-board").innerHTML="",c(s.playerBoard.cells,"player-board"),c(s.computerBoard.cells,"computer-board")};return{hideMessage:e=>{document.querySelector(`.${e}`).style.display="none"},updateScores:()=>{e.innerHTML=s.player.getScore(),r.innerHTML=s.computer.getScore()},renderBoards:d,getUserInput:async e=>new Promise(r=>{document.querySelectorAll(e).forEach((e,t)=>{e.addEventListener("click",()=>{r([Math.floor(t/10),t%10])})})}),renderMessage:(e,r)=>{const t=document.querySelector(`.${r}`);t.style.display="block",t.innerHTML=e},bindListeners:()=>new Promise(e=>{document.querySelector(".player-instruction").addEventListener("click",r=>{const t=r.target;"randomize-btn"===t.id?(s.resetGame(),s.setPlayerShipsRandomized(),s.randomizeShips(s.playerBoard),s.randomizeShips(s.computerBoard),d(),e()):"play-again-btn"===t.id?(s.resetGame(),d(),l.gameLoop(),e()):"start-btn"===t.id&&(s.resetGame(),d(),e())},!0)})}})();s.initGame(),i.renderBoards(),l.gameLoop()}]);